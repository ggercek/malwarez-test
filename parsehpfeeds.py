import sys, os
import json
import django
#from hpfeeds.models import Feed

def process(newFeed) :
    #newFeed = newFeed.strip()
    #print "<<>> %s" % newFeed
    data = json.loads(newFeed)
    f = Feed(url=data['url'], daddr=data['daddr'], saddr=data['saddr'], sport=data['sport'], dport=data['dport'], sha512=data['sha512'], md5=data['md5'])
    f.save()    

if __name__ == '__main__' :

    # Set the DJANGO_SETTINGS_MODULE environment variable.
    os.environ['DJANGO_SETTINGS_MODULE'] = "helloworld.settings"
    from hpfeeds.models import Feed

    feedsource = sys.stdin
#    with open(infile) as feedsource:
    for feed in feedsource:
       process(feed.strip())
